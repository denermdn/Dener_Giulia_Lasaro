<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <link type="text/css" rel="stylesheet" href="estilos/style.css" />
    <link href="https://fonts.googleapis.com/css2?family=Architects+Daughter&display=swap" rel="stylesheet">
    <title>TBPT - Login</title>
</head>

<body>
    <div class="tela-escura" id="login">
        <h1>Cadastro</h1> <br>
        <form action="/api/users" method="POST">
        <input type="text" id="campoNome" placeholder="Nome">
        <br><br>
        <input type="text" id="campoEmail" placeholder="E-mail">
        <br><br>
        <input type="text" id="campoConfEmail" placeholder="Confirmação do e-mail">
        <br><br>
        <input type="password" id="campoSenha" placeholder="Senha">
        <br><br>
        <input type="password" id="campoConfSenha" placeholder="Confirmação de Senha">
        <br><br>
        <button type="submit" id="btnCadastrar">Cadastrar</button>
        <br><br>            
        </form>

        <a href="./login.html"><button>Voltar à tela de login</button></a>
    </div>


    <script>
        const btnCadastrar = document.getElementById("btnCadastrar");
        btnCadastrar.addEventListener("click", async e=> {
            const jsonRequest = {}
                    userName = document.getElementById("campoNome").value;
                    if (document.getElementById("campoEmail").value == document.getElementById("campoConfEmail").value){
                        userLogin = document.getElementById("campoEmail").value;
                    }
                    else{
                        alert("Os e-mails não coincidem, digite novamente");
                    }
                    if (document.getElementById("campoSenha").value == document.getElementById("campoConfSenha").value){
                        userSenha = document.getElementById("campoSenha").value;
                    }
                    else{
                        alert("As senhas não coincidem, digite novamente");
                    }

                    console.log(userSenha);
                    let result = await fetch("http://localhost:8080/api/users", {method: "POST", 
                    headers: {"content-type": "application/json"}, body: JSON.stringify(jsonRequest) })
                    result = await result.json();
                    console.log(result);
                    createUsers(userName + ", " + userLogin + ", " + userSenha);
                    if (!result.success)  alert("FAILED! ")
        });
    </script>

</body>

</html>